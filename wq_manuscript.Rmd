---
title: "Dispersed urban-stormwater control improved stream water quality in a catchment-scale experiment"
author:
  - Christopher J. Walsh, Moss J. Imberger, Matthew J. Burns, Darren G. Bos, and Tim D. Fletcher
date: "School of Ecosystem and Forest Sciences, The University of Melbourne, 500 Yarra Boulevard, Burnley, 3121 Victoria, Australia"
output:   
  word_document:
    reference_docx: AGU_Manuscript_template.docx
csl: wrr.csl
bibliography: lsc_dbs_wq.bib
editor_options: 
  markdown: 
    wrap: 120
  chunk_output_type: inline
nocite: |
  @allaire2021,@CarpenterEtAl_2017,@walsh2021,@Vehtari_EtAl_2017,@RCoreTeam_2020,@StanDevelopmentTeam_2020,@GelmanEtAl_2004,@StanDevelopmentTeam_2020b
---

Corresponding author: Christopher J. Walsh (cwalsh\@unimelb.edu.au).

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, error = FALSE,
                      dev = "png", dpi = 300)
requiredPackages <- c("readxl","rethinking","scales","flextable","RColorBrewer",
                      "ggsci","lubridate")
lapply(requiredPackages, require, character.only = TRUE)
# load bespoke functions for producing plots and tables
source("code/misc_functions.R")
source("https://tools.thewerg.unimelb.edu.au/documents/mwstr/mwstr_functions.R")
source("https://tools.thewerg.unimelb.edu.au/documents/misc/bugDatabaseFunctions.R")
#used for table_for_word function
# Check all files on OSF are in data directory - if not download them
source("code/load_data_from_OSF.R")
# Check for data for Figure 1 (from Walsh et al (2022) PLOS Water data repository), 
# download if necessary, and load into environment
source("load_ld_scms_tables.R") #loads spatial sites table - distinguish from wq sites excel table
sites_sf <- sites
rain_gauges <- sf::st_read("data/fig1_data/rain_gauge_locs.gpkg")
pipes <- sf::st_read("data/fig1_data/pipes_L4_D8.gpkg") # From MW council drain data
L4_headwaters <- sf::st_read("data/fig1_data/L4_headwaters.gpkg")  #from mwstr v1.2 network
sites <- data.frame(readxl::read_excel("data/wq_data_compiled.xlsx"))
wq_data <- data.frame(readxl::read_excel("data/wq_data_compiled.xlsx", 
                                         sheet = "wq_data"), stringsAsFactors = FALSE)
wq_data$date_time <- lubridate::ymd_hms(wq_data$date_time)
#transformations used for modeling
wq_data$lFRP <- log10(wq_data$FRP)
wq_data$lTP <- log10(wq_data$TP)
wq_data$lNH3 <- log10(wq_data$NH3)
wq_data$lTSS <- log10(wq_data$TSS)
wq_data$sNOx <- wq_data$NOx^0.5
wq_data$lTN <- log10(wq_data$TN)
wq_data$sEC <- wq_data$EC^0.5
wq_data$lTem <- log10(wq_data$Tem)

# Calculations of proportions of below-detection-limit records reported below
# sum(wq_data$FRP < 0.001, na.rm=TRUE)/sum(!is.na(wq_data$FRP))
# sum(wq_data$NH3 < 0.001, na.rm=TRUE)/sum(!is.na(wq_data$NH3))
# sum(wq_data$NOx < 0.001, na.rm=TRUE)/sum(!is.na(wq_data$NOx))
# sum(wq_data$TN < 0.02, na.rm=TRUE)/sum(!is.na(wq_data$TN))
# sum(wq_data$TP < 0.01, na.rm=TRUE)/sum(!is.na(wq_data$TP))
# sum(wq_data$TSS < 0.5, na.rm=TRUE)/sum(!is.na(wq_data$TSS))

# calculation of mean annual rainfall over the study period in each catchment
# rainfall <- sqlQuery("SELECT sitecode, dateTime, Rain_depth FROM rainfall", "lsc")
# rainfall$dateTime <- lubridate::ymd_hms(rainfall$dateTime)
# tot_rain <- aggregate(rainfall$Rain_depth, by = list(site = rainfall$sitecode), FUN = sum)
# n_years <- as.numeric(diff.Date(range(rainfall$dateTime))/365.25)
# range(tot_rain$x/n_years) # 
ann_rain <- "870-1090"

new_X <- read.csv("data/prediction_set.csv")
new_X_N <- read.csv("data/prediction_set_N.csv")

#data frame matching ultimate EI (degrd) and maximum restr achieved at the 6 experimental sites
exp_sites <- data.frame(site = c("D8","D4","Ln","L4","Ls","L1"),
                        restr_ind = c(5,6,2,4,3,7),
                        max_restr = unique(new_X$restr)[c(5,6,2,4,3,7)],
                        degrd_ind = c(4:8,10),
                        degrd = unique(new_X$degrd)[c(4:8,10)])

ys <- c("lTP","lFRP","lTN","sNOx","lNH3","lTem","sEC","lTSS")
vars <- c("tp","frp","tn","nox","nh3","tem","ec","tss")
ylab_expressions <- list(tp = expression(bold(paste("Total P (", mu, "g P/L)"))),
                         frp = expression(bold(paste("FRP (", mu, "g P/L)"))),
                         tn = expression(bold(paste("Total N (mg N/L)"))),
                         nox = expression(bold(paste("NO"[x], "(mg N/L)"))),
                         nh3 = expression(bold(paste("NH"[4]^+{}, " (", mu, "g N/L)"))),
                         tem = expression(bold(paste("Temp. (",degree,"C)"))),
                         ec = expression(bold(paste("EC (mS/cm)"))),
                         tss = expression(bold(paste("TSS (mg/L)"))))
mod_summ <- read.csv("data/mod_summ.csv")
```

### Key points

-   A long-term catchment-scale experiment strengthens inference that urban stormwater drainage increases stream
    contaminant concentrations.

-   Dispersed stormwater control measures can reverse stormwater-induced degradation of stream water quality.

-   Achieving reference stream water quality requires retention, treatment and loss of runoff from nearly all catchment
    impervious surfaces.

### Author Contributions

**Conceptualization:** Christopher J. Walsh and Tim D. Fletcher.

**Data curation:** Christopher J. Walsh, Moss J. Imberger, and Darren G. Bos.

**Formal analysis:** Christopher J. Walsh, Moss J. Imberger, Matthew J. Burns, and Tim D. Fletcher.

**Funding acquisition:** Christopher J. Walsh, Tim D. Fletcher, and Darren G. Bos.

**Investigation:** Christopher J. Walsh, Moss J. Imberger, Matthew J. Burns, Tim D. Fletcher, and Darren G. Bos.

**Methodology:** Christopher J. Walsh, Moss J. Imberger, Matthew J. Burns, and Tim D. Fletcher.

**Project administration:** Christopher J. Walsh, Tim D. Fletcher, and Darren G. Bos.

**Software:** Christopher J. Walsh, Moss J. Imberger, and Matthew J. Burns.

**Validation:** Christopher J. Walsh, Moss J. Imberger, Tim D. Fletcher, and Matthew J. Burns.

**Visualization:** Christopher J. Walsh.

**Writing - original draft:** Christopher J. Walsh and Moss J. Imberger.

**Writing - review & editing:** Christopher J. Walsh, Moss J. Imberger, Matthew J. Burns, Tim D. Fletcher, and Darren G.
Bos.

## Abstract

Traditional urban drainage degrades receiving waters. Alternative approaches have potential to protect downstream
waters, but widespread adoption requires robust demonstration of their feasibility and effectiveness. We conducted a
catchment-scale experiment over 19 years to assess the effect of dispersed stormwater control measures (SCMs), measured
as a reduction in effective imperviousness (EI) on stream water quality in 6 sites on 2 streams. We compared changes in
those sites over 7 years as EI decreased, to changes in the 12 preceding years, and in 3 reference and 2 control
streams. SCMs reduced phosphorus concentrations and summer temperature to reference levels in dry weather where EI was
sufficiently reduced, but effects were smaller with increased antecedent rain. SCMs also reduced nitrogen concentrations
which were influenced by septic tank seepage in all sites. SCMs had no effect on suspended solids concentrations, which
were lower in urban than in reference streams. SCMs increased electrical conductivity: along with reduced temperature
this is evidence of increased contribution of groundwater to baseflows. This experiment strengthens inference that urban
stormwater drainage increases contaminant concentrations in streams, and demonstrates that such impacts are reversible
and likely preventable. Variation in degree of water quality improvement among experimental sites suggests that
achieving reference water quality would require SCMs with large retention capacity intercepting runoff from nearly all
impervious surfaces, thus requiring more downslope space and water demand. EI is a useful metric for predicting stream
water quality responses to SCMs, allowing better catchment prioritization and SCM design standards for stream
protection.

### Plain language summary

The way we drain our cities and towns pollutes and erodes our streams and rivers. Water running off, and heated by,
roofs and roads carries damaging particles and chemicals. The stormwater drains and pipes that we build transport the
polluted runoff, quickly and untreated, to downstream waters. To test if creek water quality downstream of stormwater
drainage can be restored, we conducted an experiment. 100s of rain-gardens that allow to water soak into surrounding
soils and be taken up by plants, and rainwater tanks for harvesting, were installed in two suburban catchments. We
compared before and after conditions in creeks downstream of the treatments, with conditions in other degraded urban
streams, and in undegraded forested streams. Filtering and harvesting stormwater reduced summer temperatures and reduced
concentrations of phosphorus and nitrogen, critical contaminants for healthy streams. The reductions were greatest in
dry weather, and after small amounts of rain. To achieve water quality similar to forested streams, we need rain-gardens
and harvesting systems that catch runoff from nearly every roof and road upstream. Achieving that will require reserving
space near pipe outlets to streams for final treatment systems, and finding ways to use the excess water generated by
roofs and roads.

*Index words: 0478 Pollution: urban, regional and global; 0493 Urban systems (4325); 1871 Surface water quality; 1804
Catchment; 1880 Water management;*

*Key words: river water quality, urban stormwater, watershed management, urban water management, stream restoration*

## 1 Introduction

As the global human population has grown, associated demands on fresh water, and alteration to the world's lands, have
resulted in growing water scarcity and declining water quality that threaten human societies and the freshwater
ecosystems on which they depend [@vörösmarty2010]. Cities and towns are the foci of such impacts, driving land use
activities and degrading ecosystems well beyond their boundaries, in order to feed and water their populations, and to
conduct their activities and build infrastructure [@grimm2008]. Within their boundaries, conventional approaches to
urban water management degrade rivers and streams. Streams of urban catchments are typified by flashy flow regimes,
incised and deepened channels and compromised water quality leading to shifts in their ecological structure and function
[@WalshRoyEtAl_2005]. Regionally, the impacts of urban land use on river water quality can be disproportionately large
[e.g. @piffer2021]. However, alternative land and water management practices have the potential to protect downstream
waters and provide many co-benefits to the world's cities, including greater water supply security [@walsh2016]. Their
adoption for stream protection and restoration depends on robust demonstration of their feasibility and effectiveness.

Urban lands alter the water balance of catchments by replacing vegetated land with impervious surfaces, such as roofs
and roads, which reduce rain-water infiltration and are usually efficiently drained to permit rapid routing of runoff to
downstream waters [@walsh2012]. Depending on the nature of local urban water infrastructure, these urban stormwater
drainage effects may be exacerbated by wastewater discharges, by extraction of water from streams or aquifers that flow
to them, or by channel engineering to mitigate flooding. However, even in the absence of such compounding factors, urban
stormwater drainage remains a degrading influence on stream ecosystems and their water quality, increasing the frequency
and magnitude of polluted flows. This is because conventional stormwater drainage [sensu @burns2012] greatly increases
the likelihood that sediments or other materials, and their associated pollutants, on urban surfaces will be carried to
the stream when it rains, or that a spill on an impervious surface anywhere in a catchment (e.g. liquid waste poured
down a drain, a car washed on a street, firefighting runoff) will flow to a stream even in dry weather. The resulting
pulses of polluted flow create frequent hydraulic and chemical disturbances to in-stream communities
[@WalshRoyEtAl_2005]. The range of urban activities and materials, together with the efficient hydraulic connection
between catchment and stream, result in the delivery of a diverse cocktail of pollutants to stream ecosystems
[@kaushal2020].

Partly in response to a growing awareness of these impacts, alternative drainage approaches designed to reduce the
impacts of conventional stormwater drainage have developed and matured since the 1990s [@fletcher2014]. The dominant
practice in these alternative approaches was initially largely centralized, end-of-pipe treatment using detention
basins, wet and dry ponds or wetlands. This is now shifting to smaller, dispersed systems relying on filtration and
biological uptake of pollutants (bio-filtration), with harvesting and export of excess runoff increasingly employed in
recent years [@mitchell2007; @petrucci2013]. We term all of these alternative approaches collectively 'stormwater
control'. The evolution of stormwater control has led to a complex mix of technologies employed globally. To add further
complexity, motivations for stormwater control extend beyond, and often displace or take priority over, protection of
streams. Other motivations include: protection of larger downstream water bodies (coastal or lentic), combined sewer
system management to reduce overflow frequency, mitigation of local flooding, and increasingly, the many co-benefits of
green infrastructure to city environments [@lamond2019; @kim2019].

Such complexity presents challenges for measuring and comparing the effectiveness of large-scale stormwater control on
stream ecosystems. Many experimental studies of the hydrologic and chemical performance of individual stormwater control
measures [SCMs: e.g. @bettez2012; @bratieres2008], and of the cumulative effects of SCMs on the runoff from precincts
[up to several ha in area, e.g. @bedan2009; @wilson2015], have demonstrated the effectiveness of SCMs in retaining and
treating runoff to reduce runoff volume and pollutant loads. Studies of larger-scale cumulative effects of SCMs on
stream ecosystems have been less common, with mixed results that are difficult to compare [@jefferson2017]. The
difficulty of comparison arises in part from a lack of standard methods for measuring cumulative performance of the
diverse forms and scales of SCMs compared to the cumulative impact of urban drainage [@WalshEtAl_2022]. The relative
rarity of such studies is in part a result of the challenges of conducting the necessarily long-term, large-scale
experiments required to robustly assess the effects of SCMs on stream ecosystems.

Cumulative effects of dispersed stormwater control on stream water quality have been inferred from correlations with
urban density and degree of stormwater control among catchments [@pennino2016; @hale2014], or by assessment over time
after SCM deployment either in newly developed [@selbig2008; @hopkins2017], or established catchments [@roy2014] in
comparison to control or reference catchments. Urban density has most commonly been measured as total imperviousness,
and stormwater control has been measured either categorically [@roy2014; @selbig2008; @hopkins2017], by proportion of
total catchment area upstream of SCMs [@pennino2016], or by SCM area as a proportion of total catchment area
[@hale2014]. @bell2016 used 'unmitigated' imperviousness: proportional catchment impervious area not draining to an SCM.
Other studies have accounted for stormwater control afforded by informal drainage to impervious surfaces either using
imperviousness weighted by distance to drain [@walsh2009], or by stormwater pipe density [@baruch2018].

In this study, we used the approach outlined by @WalshEtAl_2022 of integrating the degrading effects of stormwater
runoff and the restorative effects of SCMs into two comparable measures: *EI~S1~*, the proportion of catchment connected
to stormwater drainage pipes assuming SCMs have no effect; and *EI~S~*, EI weighted by the stormwater impact index,
which measures the cumulative modeled performance of upstream SCMs. Such an approach permits comparison of degradation
and restoration trajectories in response to conventional drainage and stormwater control, respectively. It also presents
an approach that could be applied across regions and cities for better comparison of studies.

We use these EI measures to assess the effects on stream water quality of the experimental implementation of dispersed
SCMs in 6 sub-catchments of 2 independent catchments. The experiment was designed as a before-after-control-reference
impact experiment conducted over 19 years, comparing changes in the 6 experimental reaches in the 7 years during and
after SCM implementation with changes in the preceding 12 years, and with changes over the full study period in streams
of 2 urban control and 3 forested reference catchments. More broadly, the experiment aimed to test if intensive
application of dispersed SCMs can restore stream hydrology, water quality and ultimately ecological state [@walsh2005;
@walsh2015]. In this paper we focus on water quality.

Most studies assessing the water quality effects of SCMs focus on annual loads, primarily to assess export to well
buffered large downstream waters. Such long-time-scale measures of water quality are of less direct relevance to
smaller, more dynamic stream and river ecosystems [@gomi2002]. We therefore assess the effects on water quality during
dominant conditions: in dry weather and following rain events up to 20 mm/d. Such conditions occur \>96% of the time in
our study streams, and are therefore likely to be prime determinants of ecological structure and function. Dispersed
SCMs are typically not designed to retain and treat runoff from storms larger than \~20 mm/d.  Rainfall depths of this
magnitude are likely to exceed the runoff retention capacity of even natural catchments in this region [@hill1998],
meaning that both urban and non-urban streams will experience hydraulic and water quality disturbance in such rainfalls.

Comprehensively accounting for the multitude of urban contaminants that are responsible for urban stormwater impacts on
urban water quality is a near-impossible endeavor [@kaushal2020]. We thus follow the approach implicit in most
legislated water quality targets of measuring variables that are nutrients of primary importance to biological processes
and in forms with varying degrees of availability; from less bioavailable (i.e. total nitrogen, TN; total phosphorus,
TP) to more bioavailable (ammonium, NH~4~^+^; nitrate + nitrite, NO~x~; filterable reactive phosphorus FRP). The
variables measured can serve as surrogates for contaminants that are mobile through soils and bioavailable (NO~x~) or
conservative (electrical conductivity, EC, as a surrogate for dominant ions), or that are bioavailable and readily
attach to particles (FRP, NH~4~^+^). We also measured the particles themselves (total suspended solids, TSS), and
temperature as a fundamental physical property driving in-stream biological processes.

In this paper, we use hierarchical linear models to assess the effects of the experimental implementation of dispersed
SCMs on the selected water quality variables in receiving streams. The experimental design permits the use of the models
to make general predictions of the effects of conventional urban stormwater as indicated by *EI~S1~*, and of varying
density and performance of stormwater control as indicated by *EI~S~*, and we use three scenarios (reference state, *EI*
= 0, i.e. no impervious surfaces or SCMs; unmitigated urban state, *EI* = *EI~S1~*, i.e. actual urban state with no
SCMs; mitigated urban state, *EI* = *EI~S~*, i.e. actual urban state with SCMs as achieved in the experiment) to
illustrate predictions, and to assess the experimental effects. The predictions will permit better planning and
implementation of stormwater control at a catchment-scale for protection of streams and rivers.

## 2 Materials and Methods

### 2.1 Study area and experimental design

The study streams are in the Dandenong Ranges on the eastern fringe of the Melbourne metropolitan area, Victoria, in
temperate south-eastern Australia (Fig. 1a). The study area experiences a warm temperate climate with warm summers and
no dry season [Köppen-Geiger climate classification cfb, @beck2018]. Mean annual rainfall over the study period was
870--1090 mm among the study catchments. The catchments' soils are generally yellow duplex type soils, with surface
texture of loamy sand, clay subsurface [@white_etal_1980].

The study was a before-after-control-reference-impact experiment, with 7 sites in independent catchments (italicised
sites in Figure 1a) comprising: three reference, forested catchments (Sa, Ly, Ol), with little or no stormwater drainage
infrastructure; two control urban catchments (Br, Fe), with streams degraded by urban stormwater drainage, and two
experimental urban catchments (L4 and D4). These sites were a subset of the sites studied by @hatt2004, selected to
minimize variation in physiographic and climatic conditions of their catchments. However, urban impacts have caused
geomorphic differences among the stream channels, with unconsolidated sediments of the more urban streams having been
eroded, resulting in incised channels consolidated clays in more urban streams. The seven independent sites were sampled
from 2001 to 2019. From November 2010, four additional experimental sites (L1, Ln, and Ls, all upstream of L4 and D8,
downstream of D4, Figure 1a) were added to the sampling program.

The experimental manipulation involved the implementation of 638 SCM projects (consisting of one or more SCMs) from 2009
to 2012 [@WalshEtAl_2022]. The SCMs were implemented through several engagement programs in the L4 catchment [\@bos2015;
@burns2015; @walsh2015], and in a parallel program in the D8 catchment led by Melbourne Water [@prosser2015]. In all
subcatchments SCMs were a mix of systems that promote exfiltration into catchment soils, which we collectively term
raingardens, and stormwater harvesting tanks (Figure 1b, c). Raingardens were primarily bio-infiltration systems without
under-drains, but some unvegetated infiltration systems were installed on space-limited streetscapes. Most tanks were
designed to passively discharge water at a low rate to surrounding garden soils (where space permitted). In D4 and D8,
downpipe diverters were also installed on many houses (Fig. 1c), but these were found to have little capacity to retain
runoff [@WalshEtAl_2022, S4]. Impervious catchment areas ranged from 10^2^ m^2^ (residential rainwater tanks or
raingardens draining private roof or paving runoff) to 10^4^ m^2^ [e.g., a precinct harvesting system in L4 intercepting
a council stormwater drain overflowing to a series of raingardens; a 1800-m^2^ vegetated infiltration system in D8
intercepting two council stormwater drains; @western2021]. While some SCMs were at or near the end of council stormwater
pipes, none were constructed on a stream. Many SCMs were in a treatment train; all 'end-of-pipe' SCMs had smaller SCMs
upslope.

The determination of temporal changes in EI resulting from urban growth and from SCM implementation in the experimental
catchments, was described in detail by @WalshEtAl_2022. Briefly, in 2001, EI ranged from 0 to 1% in the reference
catchments, and from 2 to 25% the experimental and control catchments (Table 1). Over the 19-year study period, EI grew
by 0-1% in the reference sites (e.g. Sa grew from 1.04% to 1.05%) and by 4-14% in the experimental and control
catchments (2001 vs 2019 EI~S1~ in Table 1). SCM implementation in the 6 experimental catchments (Fig. 1) reduced EI by
13-68% (2019 EI~S~ vs EI~S1~ in Table 1).

The experimental design thus permitted a comparison of temporal trends in contaminant concentrations in the 6
experimental sites after commencement of SCM implementation compared to temporal trends in those sites in the period
before implementation, and temporal trends through both the before and after periods for the reference and control
streams.

#### Table 1. Catchment statistics and experimental class (reference, control or experimental) for the 11 study sites. TI = total imperviousness, EI = effective imperviousness. EI~S1~ is the percentage of catchment connected to stormwater drainage pipes assuming stormwater control measures (SCMs) have no effect; and EI~S~ is EI weighted by the stormwater impact index, which measures the cumulative modeled performance of upstream SCMs.

```{r}
site_tab <- data.frame(Stream = c("Lyrebird","Olinda","Sassafras","Brushy","Ferny",
                              "Little Stringybark", "Little Stringybark Sth", "Little Stringybark Central",
                              "Little Stringybark Nth","Dobsons","Dobsons downstream"),
                    Code = c("Ly","Ol","Sa","Br","Fe","L4","Ls","L1","Ln","D4","D8"),
                    Class = c(rep("Reference",3),rep("Control",2),rep("Experimental",6)))
site_tab <- merge(site_tab, 
                  sites[c("cat","carea_m2","EI_S1_2001","EI_S1_2019","EI_S_2019","TI_2019","septics")],
                  by.x = "Code", by.y = "cat", sort = FALSE)
site_tab$carea_m2 <- round(site_tab$carea_m2*1e-6,1)
site_tab[c("EI_S1_2001","EI_S1_2019","EI_S_2019","TI_2019")] <- 
  round(site_tab[c("EI_S1_2001","EI_S1_2019","EI_S_2019","TI_2019")]*100,1)
site_tab$septics <- round(site_tab$septics,1)
ft <- table_for_word(site_tab)  
ft <- compose(ft, part = "header", j = 4, 
              value = as_paragraph("Catchment area (km",as_sup("2"),")"))
ft <- compose(ft, part = "header", j = 5,
         value = as_paragraph("EI",as_sub("S1")," (2001)"))
ft <- compose(ft, part = "header", j = 6,
         value = as_paragraph("EI", as_sub("S1")," (2019)"))
ft <- compose(ft, part = "header", j = 7,
         value = as_paragraph("EI",as_sub("S")," (2019)"))
ft <- compose(ft, part = "header", j = 8,
         value = as_paragraph("TI (2019)"))
ft <- compose(ft, part = "header", j = 9,
         value = as_paragraph("Septic tank density (N/km",as_sup("2"),")"))
ft
```

\*Ls, L1 and Ln are independent tributaries upstream of L4, † D4 is upstream of D8

```{r fig.width = 6.5, fig.height = 7, dev = "png", dpi = 300}
# tiff("images/Fig 1.tiff", width = 6.5*600, height = 7*600, res = 600, compression = "lzw")
layout(matrix(c(1,1,1,5,1,1,1,5,1,1,1,6,2,3,4,6), 4,4, byrow = TRUE),
       heights = c(5,2,5,2), widths = c(4,4,4,8))
# lo <- layout(matrix(c(1,2,1,3,1,4,1,5,1,6),5,2,byrow=TRUE),widths = c(5.75,1.25), 
#        heights = c(1.25,1.25,4,1.25,1.25))
par(mai = c(0.028,0.028,0.028,0.028)*0)
# A. Map of all 11 catchments (with legends and location maps below)
plot(catMap11$geometry, lty = 3, lwd = 0.5, border = "white")
title(main = "  a.", adj = 0, line = -1.5, cex.main = 2.5)
#censored to exclude IA newer than October 2009 (i.e. 2009 IA)
catIA_2009 <- catIA[is.na(catIA$constructionDate) | (!is.na(catIA$constructionDate) &
                catIA$constructionDate < "2009-10-01"),]
plot(catIA_2009$geometry,
     col = c(gray(0.6),gray(0.85),gray(0.85))[match(catIA_2009$conn,c(1,0,0.5))],
     border = c(gray(0.6),gray(0.85),gray(0.85))[match(catIA_2009$conn,c(1,0,0.5))],
     lwd = 0.5, add = TRUE)
#col converts conn = 0.5 to 0 (those surfaces that would be connected if the pits weren't full)..
#only applies in Wicks subcatchment
plot(streams$geometry, col = "dodgerblue", lwd = 2, add = TRUE)
plot(catMap11$geometry, lty = 3, lwd = 2, border = catMap11$col, add = TRUE)
plot(siteMap11$geometry, pch = 21, bg = siteMap11$col, cex = 1.25, add = TRUE)
siteLabels$font[siteLabels$font == 1] <- 2 #make both normal and italic fonts bold
text(st_coordinates(siteLabels),siteLabels$sites_p, cex = 1, font = siteLabels$font)
arrows(st_coordinates(siteLabels)[siteLabels$siteLabel == "LS"][1]-200,
       st_coordinates(siteLabels)[siteLabels$siteLabel == "LS"][2],
       st_coordinates(siteMap11)[siteMap11$sitecode == "LSS0001"][1],
       st_coordinates(siteMap11)[siteMap11$sitecode == "LSS0001"][2], length = 0.05)
arrows(st_coordinates(siteLabels)[siteLabels$siteLabel == "LM"][1],
       st_coordinates(siteLabels)[siteLabels$siteLabel == "LM"][2]+100,
       st_coordinates(siteMap11)[siteMap11$sitecode == "LIS0001"][1],
       st_coordinates(siteMap11)[siteMap11$sitecode == "LIS0001"][2], length = 0.05)
arrows(st_coordinates(siteLabels)[siteLabels$siteLabel == "LN"][1],
       st_coordinates(siteLabels)[siteLabels$siteLabel == "LN"][2]-100,
       st_coordinates(siteMap11)[siteMap11$sitecode == "LSN0001"][1],
       st_coordinates(siteMap11)[siteMap11$sitecode == "LSN0001"][2], length = 0.05)
plot(rain_gauges$geom, pch = 6, add = TRUE, cex = 1)
raster::scalebar(2000, xy = c(355500,5801500), 
                 label= "2 km", cex = 1)
# bounds of plot b and c derived with par("usr") (commented out in scmMap_v2 function)
polygon(c(357322.2, 357322.2, 359184.2, 359184.2),
        c(5815869.4, 5818668.5, 5818668.5, 5815869.4) )
polygon(c(351825.4, 351825.4, 353125.1, 353125.1),
        c(5807433.1, 5809387.0, 5809387.0, 5807433.1) )
rng <- par("usr")
box(lwd = 2)
legend("bottomleft", 
       pch = 15, col = c(gray(0.6),gray(0.85)),cex = 1,
       legend = c("Connected","Unconnected"), title = "Impervious areas",
       box.lwd = 2)
legend("bottomright", legend = "Rain gauges", cex = 1, pch = 6, 
       pt.cex = 1,box.lwd = 2)
plot.new()
legend("center", lty = c(3,3,3), lwd = c(2,2,2), cex = 1,
       col = c(RColorBrewer::brewer.pal(3,"Dark2")), title = "Catchments",
       legend = c("Control","Experimental","Reference"), text.col = "white")
legend("center", pch = 21, cex = 1,
       pt.bg = c(RColorBrewer::brewer.pal(3,"Dark2")),
       title = "Catchments",
       legend = c("Reference","Experimental","Control"), bty = 'n',box.lwd = 2)
rngPoly <- st_sfc(st_polygon(list(rbind(rng[c(1,3)], rng[c(1,4)], rng[c(2,4)], 
                                 rng[c(2,3)],rng[c(1,3)]))))
rngPoly <- st_sf(a = 1, geom = rngPoly)
st_crs(rngPoly) <- 28355
rngPoly <- rngPoly %>% st_transform(4283)
par(mai = c(0.028,0.028,0.028,0.028) * 0)
plot(Australia_GDA94_GCS$geometry)
plot(Victoria_GDA94_GCS$geometry, col = "white", add = TRUE)
polygon(c(142.2209,147.7791,147.7791,142.2209),c(-39.2040,-39.2040,-36.3960,-36.3960), col = scales::alpha(gray(0.5),0.5))
plot(rngPoly$geom, col = "black", add = TRUE)
title(main = "Australia", adj = 0, 
      font.main = 1, line = -1, cex.main = 1)
box(lwd = 2)
bounds <- st_sfc(st_point(c(143.5,-36.5)), st_point(c(146.5,-39.1)),crs=4283)
plot(bounds, col = "white")
plot(Victoria_GDA94_GCS$geometry, add = TRUE)
rng_vic <- par("usr")
plot(rngPoly$geom, col = scales::alpha(gray(0.5),0.5), add = TRUE)
title(main = "Central Victoria ", 
      adj = 1, font.main = 1, line = -1, cex.main = 1)
box(lwd = 2)

# B. Detail of SCMs in L4 catchment (and its subcatchments)
siteLabels <- siteLabels[match(siteMap11$sitecode,siteLabels$sitecode),]
siteMap11_b <- siteMap11[siteMap11$sitecode %in% c("LIS0001","LSN0001","LSS0001"),]
siteLabels_b <- siteLabels[siteLabels$sitecode %in% c("LIS0001","LSN0001","LSS0001"),]
label_shift_b <- matrix(c(400,-600,0,450,-1000,0), nrow = 3, byrow=TRUE)
lab_coords <- st_coordinates(siteMap11_b) + label_shift_b
scmMap_v2(71, addLegend = FALSE,addSCMNetwork = FALSE, ZoomToSCMs = TRUE)
plot(catMap11$geometry, lty = 3, lwd = 2,  border = catMap11$col,  add = TRUE)
plot(siteMap11_b$geometry, pch = 21, bg = siteMap11_b$col, cex = 1.25, add = TRUE)
siteLabels_b$font[siteLabels_b$font == 1] <- 2 #make both normal and italic fonts bold
text(lab_coords,siteLabels_b$sites_p, cex = 1, font = siteLabels$font)
for(i in 1:3){
  arrows(st_coordinates(siteMap11_b)[i,1] + label_shift_b[i,1], 
         st_coordinates(siteMap11_b)[i,2] + label_shift_b[i,2], 
         st_coordinates(siteMap11_b)[i,1],st_coordinates(siteMap11_b)[i,2],length = 0.05)
}
title(main = " b.", adj =  0, line = -1.5, cex.main = 2.5)
box(lwd = 2)
# C. Detail of SCMs in L4 catchment (and its subcatchments)
scmMap_v2(103, addLegend = TRUE,addSCMNetwork = FALSE, ZoomToSCMs = TRUE)
plot(catMap11$geometry, lty = 3, lwd = 2,  border = catMap11$col,  add = TRUE)
siteMap11_c <- siteMap11[siteMap11$sitecode %in% c("DBS0004","DBS0008"),]
siteLabels_c <- siteLabels[siteLabels$sitecode %in% c("DBS0004","DBS0008"),]
label_shift_c <-matrix(c(-300,300,0,100), nrow = 2, byrow=TRUE)
lab_coords <- st_coordinates(siteMap11_c) + label_shift_c
plot(siteMap11_c$geometry, pch = 21, bg = siteMap11_c$col, cex = 1.25, add = TRUE)
siteLabels_c$font[siteLabels_c$font == 1] <- 2 #make both normal and italic fonts bold
text(lab_coords,siteLabels_c$sites_p, cex = 1, font = siteLabels$font)
for(i in 1:2){
  arrows(st_coordinates(siteMap11_c)[i,1] + label_shift_c[i,1], 
         st_coordinates(siteMap11_c)[i,2] + label_shift_c[i,2], 
         st_coordinates(siteMap11_c)[i,1],st_coordinates(siteMap11_c)[i,2],length = 0.05)
}
title(main = " c.", adj =  0, line = -1.5, cex.main = 2.5)
box(lwd = 2)
# dev.off()
```

### Fig. 1. a. The 11 monitoring sites and their catchments, coloured as control, experimental or reference. Impervious surfaces (only surfaces inside the study catchments shown) are shaded by their connection to the stormwater drainage system in 2019. Rain gauges used to estimate catchment rainfall are also indicated.The grey rectangle in the map of Central Victoria, Australia, shows the location of the main map. b. Detail of the upper L4 catchment showing council stormwater drainage pipes and all stormwater control measures and their type (see text) installed in the experiment. c. A similar detail of the lower D8 catchment.

### 2.2 Data collection

Water samples were collected from the seven sites in independent catchments from 2001 to 2019 over three periods.
Regular samples were collected every second week for 29 months from Sep 2001 to Jan 2003, and monthly for 21 months from
Feb 2004 to Nov 2005 (except for Br and Fe) and for 10 years from May 2009 to Jul 2019. In addition to the regular
samples in these periods, we collected samples during 6--12 rain events per year, ensuring samples in each year captured
baseflow and stormflow conditions. From Nov 2010, the four additional experimental sites were also included in the
sampling program. Sites were sampled in one of four possible orders on each sampling occasion to ensure samples from
each site were taken at a range of times.

We recorded EC with a TPS Direct Reading Conductivity Meter Model 2100 (<https://tps.com.au/>) and temperature with a
'H~2~O' water quality multiprobe (<https://www.hydrolab.com/>) in 2001-2002, and both variables using a Horiba U-10
multiprobe (<https://www.horiba.com/>) or a YSI 6920 V2 multiprobe (<https://www.ysi.com/>) thereafter. We collected
samples for TN, TP, NO~x~, NH~4~^+^, filterable reactive phosphorus (FRP) and total suspended solids (TSS). Samples for
NO~x~, NH~4~^+^, and FRP were filtered in the field using 0.2 μm filters from 2001 to 2003, and 0.45 μm filters
thereafter. This change of filter type was inconsequential: see consideration of the *filter* predictor below. All
bottles were stored on ice until returned to the laboratory (\< 5 h). All analyses were performed in a NATA (National
Association of Testing Authorities, <https://nata.com.au/>) accredited laboratory following standard methods
[@APHA_2012_all].

Very few records were below detection limit. Two FRP values (\<0.1% of all FRP records), 8 NO~x~ values (0.4%), and 11
NH~4~^+^ values (0.5%) were less than the detection limit of 0.001 mg/L. No TN values were less than the detection limit
of 0.2 mg/L, 19 TP values (0.8%) were less than the detection limit of 0.1 mg/L and 1 TSS value (\<0.1%) was less than
the detection limit of 0.5 mg/L. For all variables, below-detection-limit records were set at half the detection limit
in the statistical models.

Determination of impervious areas, drainage connection, and SCM implementation and performance over the study period,
used to calculate EI-related predictor variables, was described in detail by @WalshEtAl_2022. Rainfall predictor
variables were calculated from 6-minute-time-step rainfall data over the study period. For each catchment, a weighted
average 6-minute rainfall time series was estimated using available gauge data (Bureau of Meteorology's Montrose
(086076) and Ferny Creek (86266) gauges; Melbourne Water's Brushy Creek (229249A), Dandenong Creek (228373A), Silvan
(586177), Mt Dandenong (586090), and Mt Evelyn (229690A) gauges, and five gauges installed by the project team over
different periods in the L4 and D8 catchments), and the Bureau of Meteorology daily rainfall grid (Figure 1, see
@walshEtAl_2022, S3 for a detailed description of the methods used to calculate catchment-weighted averages). Septic
tank density was estimated from a dataset of unsewered properties supplied by Yarra Ranges Council in 2000, and
South-East Water for the D4 catchment in 2016. These data are likely to be reliable for the study period as there were
no sewer upgrade programs in the study catchments.

### 2.3 Statistical analyses

For each of the eight water quality variables (FRP, TP, NO~x~, NH~4~^+^, TN, TSS, EC and temperature) we assessed the
effect of dispersed SCMs using a hierarchical linear model as described by @WalshEtAl_2022. The two primary
stormwater-related effects of the model are:

-   *degrd*, the putative degrading effect of urban stormwater runoff, represented by log~10~(*EI~S1~* + 0.1), where
    *EI~S1~* is percentage effective imperviousness assuming SCMs have no effect;

-   *restr* the putative restorative effect of SCMs, represented by $\Delta EI_S$, the difference between
    log~10~(*EI~S1~* + 0.1) and log~10~(*EI~S~* + 0.1), where *EI~S~* is effective imperviousness, with impervious areas
    upstream of SCMs weighted by S, a metric of performance. S measures reduction in uncontrolled runoff frequency,
    runoff volume, and contaminant concentrations, and restoration of filtered flows: see @WalshEtAl_2022

In the before phase of the experiment (2001 to 2009), the six experimental sites had *EI~S1~* values spanning the range
of *EI~S1~* between the control sites and reference sites. In all but two sites (the reference sites Ly and Ol, Table
1), *EI~S1~* increased over the study period, but this growth in imperviousness was small in the log domain (Figure 2).
$\Delta EI_S$ was zero for the entire study period for the reference and control sites, and for the experimental sites
in the before phase. It became increasingly negative after the SCMs began being implemented. If the SCMs completely
mitigated the effect of urban stormwater runoff, then the *degrd* (*EI~S1~* )and *restr* ($\Delta EI_S$) effect sizes
should be equivalent.

```{r Fig_2, dev = "pdf", fig.width = 6.5, fig.height = 3}
# tiff("images/Fig 2.tiff", width = 6.5*600, height = 3*600, res = 600, compression = "lzw")
site_tab$sitecode <- sites$sitecode[match(site_tab$Code,sites$cat)]
par(mar = c(4,6,2,1))
layout(matrix(1:3,1,3,byrow=TRUE),widths = c(10,10,2))
plot(wq_data$date_time, jitter(wq_data$restr, factor = 4), 
     col = (RColorBrewer::brewer.pal(12,"Paired")[c(1:10,12)])[match(wq_data$sitecode, site_tab$sitecode)],
     ylab = expression(~Delta~EI[S]), xlab = "Year", las = 1)
title(main = "a.", adj = 0, line = 0.5)
plot(wq_data$date_time, jitter(wq_data$degrd, factor = 4), 
     col = (RColorBrewer::brewer.pal(12,"Paired")[c(1:10,12)])[match(wq_data$sitecode, site_tab$sitecode)],
     ylab = expression(log[10](EI[S1] + 0.1)), xlab = "Year", las = 1)
title(main = "b.", adj = 0, line = 0.5)
par(mar = c(0,0,0,0))
plot.new()
legend("center",pch = 1,  
       col = RColorBrewer::brewer.pal(12,"Paired")[c(1:10,12)], 
       legend = site_tab$Code, 
       title = "Site", cex = 1)
# dev.off()
```

#### Figure 2. Variation in a. *restr* ($\Delta EI_S$) and b. *degrd* (log~10~(*EI~S1~* + 0.1)) in each site over the study period for every water quality sample used in the models. Both restr and degrd are in the log domain.

All eight water quality response variables were modeled as being drawn from a normal distribution:

$$
y_{i} = Normal(\mu_{i}, \sigma)
$$

(eq. 1)

where *y~i~* is the value of the response variable in the *i*th sample, and $\mu_i$ is the mean estimate for the sample
and $\sigma$ is the residual standard deviation. To approximate such a distribution, FRP, TP, NH~4~^+^, TN, TSS and
temperature were log~10~-transformed, and NO~x~ and EC were square-root transformed.

The basic model assessing the effects of *degrd* and *restr* in the before-after-control-reference-impact experiment
[@WalshEtAl_2022] estimated $\mu_i$ as:

$$
\mu_i = \alpha + \alpha [site_j] + \beta_D degrd_i + \beta_R restr_i + \beta_{T}[site_j] t_i + \beta_A autoT_i
$$

(eq. 2)

where $\alpha$ is the global intercept; $\alpha [site_j]$ is the random variation to that intercept for site *j*;
$\beta_D$ represents the effect of *degrd*; $\beta_R$ represents the effect of *restr* (only non-zero in experimental
sites after SCM manipulation had begun); $\beta_{T}[site_j]$ represents the effect of time, t (standardised to range
between -1.5 and 1.5), within the site *j*; $\beta_A$ represents the effect of temporal autocorrelation, *autoT*, among
samples from each site. We thus modeled a random effect of site in the intercept and in the slopes of the time effects
(allowing for different trends over time among sites unrelated to the experimental effect), but fixed effects of *degrd*
and *restr* . However, models of temperature, NO~x~ and TN did not consistently converge with a variable time effect,
and as the time effect was near-identical among sites, we modeled time as a fixed effect for these variables.

For each model, *autoT* was the mean residual value from a model with the same structure, for the preceding 45 days in
each site. The use of residuals of models without autocorrelation terms has been demonstrated as an effective method of
accounting for autocorrelational effects [@Crase_EtAl_2012]. In a preliminary analysis we compared model fits using
*autoT* calculated using antecedent periods from 1 to 120 days, and found 45 days to be the optimal period for this
dataset.

Stream contaminant concentrations and temperature vary in response to flow [e.g. @guo2020], and both urban stormwater
drainage and SCMs alter the response of stream flow to rainfall. We thus used antecedent rainfall as a predictor
variable in our models to avoid conflation of the effect of flow on stream concentrations and the effect of urban
stormwater runoff and SCMs on stream flow. As stormwater drainage conveys impervious runoff rapidly to the stream,
recent rainfall (within hours) is a more likely predictor of change to flow than less recent rainfall. Similarly, the
potential for SCMs to have sufficient void to prevent rapid runoff is likely to be predicted by recent rainfall. We thus
included rainfall depth in the preceding 24 h (*rain1*) of each sample as a fixed predictor, as well as the interactions
of *rain1* with *degrd*, and with *restr*, on the premise that the effects of stormwater drainage and SCMs will likely
vary with depth of rainfall events.

Our study design included sites with spatial dependence: L1, Ln, and Ls are 1.7, 1.7 and 1.4 stream-km upstream of L4,
respectively, and D4 is 0.9 stream-km upstream of D8. We thus also included a spatial autocorrelation term, *autoS*, in
all models, which was applied to samples from L4 and D8. *autoS* was the mean of values recorded in L1, Ln, and Ls on
the same date for L4, and the value recorded in D4 on the same date for D8.

The primary model of each variable (for which the time effect, $\beta_{t}$, varied among sites) was thus:

$$
\mu_i = \alpha + \alpha [site_j] + \beta_D degrd_i + \beta_R restr_i + \beta_p * rain1_i + \beta_{pd} (rain1_i * degrd_i) + \beta_{pr} (rain1_i * restr_i) + \beta_{t}[site_j] t_i + \beta_{at} autoT_i + \beta_{as} autoS_i 
$$

(eq. 3) <!--# (Model m_1_st) -->

We aimed to ensure that each model adequately accounted for sources of variation unrelated to our experimental
manipulation. We therefore calculated and compared the primary model to a range of more complex models. For each
variable, we added up to three additional predictors to the primary model, and improvement in model fit was assessed by
differences in the leave-one-out estimate of out-of-sample predictive fit (ELPD~loo~: @Vehtari_EtAl_2017) to select the
best-fit model for each response variable. ELPD~loo~ is analogous to widely used information criteria: models with
difference in ELPD~loo~ greater than 4 or greater than twice the standard error of the difference have better predictive
performance [@vehtari_etal_2022] and were considered more plausible. Additional variables included in candidate models
were:

-   *season*, a sinusoidal curve with a period of 1 year, a maximum of 1 on the summer solstice (December 21) and a
    minimum of -1 on the winter solstice. This variable represents seasonal changes in climate and instream biological
    activity, and was included in models for all variables as an additional term $\beta seas * season$

-   *rain365*, sum of antecedent rainfall depth over the preceding year. This variable is an indicator of longer-term
    water storage and baseflow contribution from catchment soils, and was included (log~10~-transformed) in models for
    all variables as an additional term $\beta{r365} * rain365$.

-   *channel*, which was zero for all samples, except for samples from L4 and Ln for two years after 300 m of vegetated
    channel and banks, \~ 300 m upstream of Ln, were disturbed by mechanical re-profiling and vegetation removal,
    resulting in liberation of fine sediments. The variable represents the potential for the exposed sediments to
    mobilize contaminants during the period that channel vegetation returned. We included this variable in candidate
    models of FRP, TP, NO~x~, NH~4~^+^, TN, and TSS as an additional term $\beta{c} * channel$.

-   *diel*, a sinusoidal curve with a period of 1 day, a maximum of 1 at 1800 h, when stream temperature is likely to be
    at its daily maximum, and minimum of -1 as 0600 h. This variable was only applied to models of temperature as an
    additional term $\beta_{diel} * diel$. All candidate temperature models included both *season* and *diel*, as we
    expected such temporal variation was likely to be a dominant determinant of stream temperature. We also considered a
    model with interactions of season with *restr* and *degrd*
    ($\beta seas_d * season * degrd + \beta seas_r * season * restr$), to represent the possibility that stormwater
    effects on temperature vary with season; and a model with those interactions together with interactions of diel with
    *restr* and *degrd* ($\beta diel_d * diel * degrd + \beta diel_r * diel * restr$), to represent stormwater effects
    on diel variation in temperature.

-   *septic,* the density of septic tanks in each catchment. Because of the mobility of NO~x~ through soils, and the
    variability in sewerage infrastructure among the study catchments, NO~x~ and TN concentrations in the study streams
    are likely to be more strongly predicted by *septic* than by effective imperviousness [@hatt2004]. We included this
    variable (square-root-transformed) in all candidate models of NO~x~ and TN ($\beta e * septic$), and also trialed
    the addition of its interaction with *rain1* ($\beta pe * rain1 *septic$).

-   *filter,* a binary variable distinguishing samples of FRP, NO~x~ and NH~4~^+^ taken up until 2003, using 0.2-μm
    filters from those taken later using 0.45-μm filters, to account for any temporal variation in those variables that
    may have resulted from this methodological change. We assessed the effect of including *filter* in all candidate
    models (see below) of FRP, NO~x~ and NH~4~^+^ ($\beta f * filter$). The *filter* effect for FRP and NH~4~^+^ was
    near-zero, and its inclusion in the NO~x~ model introduced multicollinearity with the effect of time. The inclusion
    or exclusion of a filter effect did not change the estimates of the experimental effects in any of the models (See
    Text S1, Figure S2). We thus concluded that the effect of changing filters after 2003 was inconsequential and
    elected to not consider *filter* further, or include it in candidate models reported here.

Combining the additional variables (other than *filter*) with the primary model (eq. 3) resulted in comparison of 8
models for FRP, TP, NO~x~, NH~4~^+^, TN, and TSS (primary model plus combinations of *channel*, *season*, *rain365*), 16
models for NO~x~ and TN (additional 8 models including *septic* with and without an interaction with *rain1*), 4 models
for EC (primary model plus combinations of *season* and *rain365*), and 6 models for temperature (primary model plus
*season* and *diel* and combinations of *rain365* and interactions as described above). See Table S1, for the full list
of models.

All $\alpha$ and $\beta$ parameters were drawn from a weakly informative normal distribution (mean 0, standard deviation
5), except for the random site parameters $\alpha s$ and $\beta t$, which were drawn from hyperdistributions with a mean
drawn from a normal distribution with mean 0 and standard deviation 5, and standard deviation drawn from a half-Cauchy
distribution (mean 0, standard deviation 2). We derived the models using the Markov Chain Monte-Carlo sampler of Stan
[@CarpenterEtAl_2017], ensuring standard diagnostic tests of model performance were satisfied, and that each model
provided accurate predictions of the data. See Text S1 for further details.

### 2.3.1 Model prediction for assessment of stormwater control effects

To aid interpretation of the predictions of water quality responses to the degrading effects of urban stormwater
(*degrd*) and the potentially restorative effects of SCMs (*restr*), we made general predictions of each response
variable to a range of predictor variables by setting site-specific random parameters to their mean values.

We first explored the primary effects of interest (*restr*, *degrd* and *rain1*) and their interactions, first by
comparing the response of each variable to rain1 under three scenarios:

a)  a stream with *EI~S1~* equivalent to each experimental site at the end of the study, with no SCMs (i.e. each site as
    it would be without SCM implementation);

b)  a stream as in a), but with the SCMs achieved in that catchment at the end of the study (i.e. each site as it was
    after SCM implementation);

c)  a reference stream (zero *EI~S1~*, zero SCMs).

For all scenarios for all variables, where relevant, *season* was set to the equinox, except for temperature, for which
season was set to the summer solstice and *diel* to 1800 h (i.e. their maximum values); *rain365* to its mean value;
*channel* to zero; *septic* to the value for each experimental catchment; and *t* to the end of the study. *autoT* and
*autoS* were excluded from the predictions to new data, as they were for modeled data points that had no antecedent or
upstream dependent data.

In those contexts we predicted responses to combinations of a range of *degrd* values encompassing and including the
2019 values for each site; a range of *restr* values encompassing and including the minimum values (2019: i.e. maximum
SCM implementation) achieved in each site; a range of rain1 values, including 0, 2 and 8 mm (the 50th, 75th, and 90th
percentile rain1 values for all days between 2001 and 2019) and 20 mm (the typical maximum storage of installed SCMs).
They thus represent dominant conditions. The 75th percentile is of particular importance because regional water quality
concentration objectives for TP, TN and EC are set to the 75th percentile concentration [@epavic2021]. To assess the
potential for SCM implementation to meet these management targets, we compared predicted concentrations of these
variables for the 75th percentile rainfall to the relevant objectives for our study streams (Central foothills and
coastal plains, Yarra lowlands).

For *rain1* = 0, 2, 8 and 20 mm, we calculated differences in posterior distributions of each response variable between
scenarios:

-   

    a)  minus b) (above) to assess the degree to which SCM implementation changed the variable;

-   

    b)  minus c), to assess the degree to which the response variable approached reference condition after SCM
        implementation.

To compare the response of each variable to *restr* (i.e. SCM implementation) with that to *degrd* (i.e. inferred impact
of stormwater drainage from EI), we first plotted the predicted response to *degrd* (EI~S1~) for *rain1* = 0, 2, 8 and
20 mm, assuming no SCMs (i.e. *restr* = 0) and setting other predictors as described above. For each experimental site,
we plotted two points on each of these plots, corresponding to scenarios a) and b) above, to indicate the direction of
response to SCM implementation. The EI value assigned to scenario a) equaled EI~S1~ and to b) equaled EI~S~.

## 3 Results

### 3.1 Model selection and assessment

For each response variable, the model with maximum ELPD~loo~ was selected for assessment (Text S1, Table S1). A clearly
best model was evident for NO~x~, TN and temperature (Table S1). For other variables, addition of *season*, *rain365*
and *channel* to the primary model (Eq. 3) made only small differences to model fit. Additional variables made no
consequential difference to the effects of the predictors of primary interest (*restr, degrd, rain1* and interactions).
Models selected for assessment were:

-   FRP, primary model + *channel* + *season*;

-   TP and TSS, primary model + *season*;

-   NH~4~^+^, primary model + *season* + *rain365*;

-   EC, primary model;

-   NO~x~ and TN, primary model (with fixed time effect) + *septic* + *septic:rain1* +*season* + *rain365*;

-   Temperature, primary model (with fixed time effect) + *season* + *diel* + *rain365* + *season:degrd* + *diel:degrd+
    season:restr* + *diel:restr*.

All eight selected models predicted their response variable well (*R* of predicted to observed 0.76-0.94, Figures
S3-S10). In all models, the *autoT* and *autoS* effects were strongly positive (Figure 3), and the addition of these
autocorrelation terms improved the estimation of other parameters without significant change to mean estimates. The
effect of *time* did not differ from zero for any response variable except temperature (Figure 3f), for which an
increase of 0.9$^\circ$C over the study period was predicted. This estimate closely matches the increase in mean air
temperature of 0.95$^\circ$C over the same period in a nearby weather station (Scoresby, \<<http://bom.gov.au>\>).
*Rain365* had a positive effect on TN and NO~x~ (Figure 3c, d, e) suggesting their concentrations increased in wetter
periods with higher baseflow contribution to streams. *Season* had a small positive effect on TP, FRP and TSS (Figure
3a, b, h), meaning their concentrations tended to be higher in summer: conversely TN and NO~x~ were lower in summer
(Figure 3c, d). *Season* and *diel* both had positive effects on temperature, pointing to highest temperatures in summer
and late afternoon, but these effects interacted with the *restr* and *degrd*, because urban stormwater impacts increase
the amplitude of seasonal and diel temperature changes. In assessing temperature effects below, we focus on periods of
maximum temperature, as these are likely to be of greatest significance to biotic response. The channel works upstream
of Ln in 2016 (*channel* effect) increased FRP by 18.9% (95% credible interval 4--35.3%) (Figure 3b).

```{r Fig_3, fig.height=8, fig.width=6}
vars <- c("tp","frp","tn","nox","nh3","tem","ec","tss")
panel_labs <- list(tp = "a. TP",frp = "b. FRP", tn = "c. TN",
                   nox = bquote(d.~NO[x]),
                   nh3 = bquote(e.~NH[4]^"+"),
                   tem = "f. Temperature","g. EC",tss = "h. TSS")
# file compiled in wq_methods_D_model_selection.Rmd
mod_coeffs <- read.csv("data/coeffs_8vars.csv")
lo <- layout(matrix(c(1:8,9,9),5,2,byrow=TRUE), 
             widths = c(10,10), heights = c(rep(10,3),11,1))
for(i in 1:length(vars)){
  coeffs_i <- mod_coeffs[mod_coeffs$var == vars[i],]
  #Include only fixed effects: see S1 for plots of random effects
  if(vars[i] %in% c("tn","nox","tem")){
    coeffs_i <- coeffs_i[!grepl("a_s",coeffs_i$par),]
  }else{
    coeffs_i <- coeffs_i[!grepl("a_s",coeffs_i$par) & !grepl("b_t",coeffs_i$par),]
    }
  coef_plot_fig1(coeffs_i, xticklabs = ifelse(i < 7, FALSE, TRUE))
  title(main = panel_labs[[i]], adj = 0, font.main = 1, line = 0.1)
}
par(mar = c(0,0,0,0)); plot.new(); 
title(xlab = "           Coefficient", line = -1,font.lab = 1)
```

#### Figure 3. Coefficient plots for models of a. total phosphorus, b. filterable reactive phosphorus, c. total nitrogen, d. nitrate + nitrite, e. ammonium, f. temperature, g. electrical conductivity, h. total suspended solids. Each plot shows the mean, 80% (thick line) and 95% (thin line) confidence intervals for the fixed effects (see text for effect definitions), and the mean time effect in models in which time varied by site (see Figures. S3-S10 for site-specific random effects). The coefficient axes are on a common scale as all response variables were centered and standardized.

### 3.2 Degradation and restoration effects interact with antecedent rain

The effects of primary interest---*degrd* and *restr*, and *septic* for TN and NO~x~---varied in their effect among
response variables, and in most cases these effects varied with *rain1* (interaction terms in Figure 2). The form of
these interactions is illustrated for Ln (the catchment with the greatest stormwater control) in Figure 4, and
differences between scenarios a) and b), and b) and c) under the 4 rain conditions are shown for all 6 experimental
sites in Figure 5.

TP concentrations increased strongly with *rain1* in all study streams, but were consistently lower in reference streams
than in control streams. SCMs in Ln reduced TP concentrations to reference levels after little or no rain (Figure 4a,
5a.II). As a result, Ln met the Victorian government objective for TP concentration after SCM implementation, when it
would have failed without SCMs (Figure 4A). SCMs also reduced FRP concentrations in Ln after little or no rain, but not
quite to reference levels (Figure 4b, 5b.II). FRP concentrations in reference streams increased only weakly with *rain1*
up to 20 mm (Figure 4b), so that differences in concentrations between streams with and without urban drainage increased
with rainfall. The absolute reduction in both TP and FRP concentrations by SCMs in Ln was similar across all *rain1*
values, with increasing uncertainty after larger rain events (Figure 5a.i, b.i), however, log-transformed concentrations
after higher rainfall became more like urban control streams than reference streams (Figure 4a, b). SCM-induced
reductions in P were observed in Ln, Ls and L4, but reductions in D8, D4 and L1, which received less reduction in EI,
were near zero (Figure 5a.i, b.i).

TN, NO~x~ and NH~4~^+^ concentrations in control and reference streams were poorly predicted by *rain1* (Figure 4c, d,
e). SCMs reduced TN and NO~x~ after little or no rain in Ln, Ls, L4, D8, and D4, but no reduction was predicted in TN
after 8 mm (Figure 5c.I) or in NO~x~ after 2 mm (Figure 5d.i), and an increase in both TN and NOx was predicted after
higher rainfall. The SCM-induced reduction in TN increased the likelihood that Ln would meet the government objective
for TN concentration (Figure 4c). These variations in TN and NO~x~ in response to *rain1* and to SCM installation in
control and experimental streams fell within the range of concentrations for reference streams (Figure 4c, d; 5c.ii,
d.ii). SCMs reduced NH~4~^+^ concentrations across the range of *rain1* (Figure 5e.i), making concentrations more
consistent with reference concentrations (Figure 4e).

Summer control and experimental stream temperatures were 4-5 C$^\circ$ warmer than reference streams (Figure 4f). SCMs
reduced summer stream temperatures in all experimental streams after 0-8 mm of rain (Figure 5f.i). The reduction in
temperature in Ln was large enough to approximate reference temperatures after 0 and 2 mm of rain (Figure 5f.ii).

EC was poorly predicted by *rain1* in reference streams, rarely exceeding 0.2 mS/cm, while in control streams EC was
typically 0.4-0.7 mS/cm during dry weather, reducing to 0.2-0.4 mS/cm after 20 mm of rain (Figure 4g). SCMs increased EC
in all experimental streams during dry weather (Figure 5g.i), increasing the difference from reference condition (Figure
4g, Figure 5g.ii). Ln exceeded the government objective for EC with and without SCM implementation (Figure 4g).

TSS concentrations increased with *rain1*, and reference streams had higher concentrations than control streams after
0-2 mm of rain (Figure2h, Figure 5h.ii). SCMs had no effect on TSS concentrations (Figure 4h, Figure 5h.i).

### 3.3 Restoration response v. degradation response

Only TP, FRP, temperature and EC showed a strong positive response to EI~S1~ among the study sites (Figure 6a, b, f, g).
SCMs reduced TP and FRP concentrations more than predicted by the degradation trend of EI~S1~ in dry weather (Figure
6a.i, b.i). This was also the case for temperature after up to 8 mm of rain (Figure 6f). After 2-8 mm of rain, the
response of TP and FRP to SCMs matched the degradation trend closely (Figure 6a.ii, iii, 5B.ii, iii), as did the
response of temperature after 20 mm (Figure 6f.iv). After 20 mm, the response of TP and FRP to SCMs was less than
predicted by the degradation trend (Figure 6a.iv, b.iv).

The increase in EC in response to SCMs was in the opposite direction to the degradation trend (Figure 6g). The lack of
response of TSS to SCMs was consistent with the EI being a poor predictor of TSS concentrations (Figure 6h).

Although TN, NO~x~ and NH~4~^+^ were not well predicted by EI~S1~, the reduction of EI by SCMs resulted in a reduction
in their concentrations in dry weather, and for TN and NH~4~^+^ after 2 mm of rain, and for NH~4~^+^ after 8-20 mm
(Figure 6c, d, e).

```{r Fig_4, fig.height=8, fig.width=5}
lo <- layout(matrix(c(1:8,9,9),5,2,byrow=TRUE), 
             widths = c(10,10), heights = c(rep(10,3),11,1))
#Additional predictors to base model for each wq variable and value used for prediction
adds <- list(tp = data.frame(par = c("season"),value = 0),
             frp = data.frame(par = c("channel","season"),value = c(0,0)),
             tn = data.frame(par = c("season","rain365","septic"),value = c(0,0,-0.2140014)),
             nox = data.frame(par = c("season","rain365","septic"),value = c(0,0,-0.2140014)),
             nh3 = data.frame(par = c("season","rain365"),value = c(0,0)),
             tem = data.frame(par = c("season","diel","rain365"),value = c(1,1,0)),
             ec = data.frame(par = NULL,value = NULL),
             tss = data.frame(par = c("season"),value = 0))

vars <- c("tp","frp","tn","nox","nh3","tem","ec","tss")
for(i in 1:length(vars)){
  new_Xi <- data.frame(readxl::read_excel("data/prediction_set.xlsx", 
                            sheet = paste0("new_X_", vars[i])), stringsAsFactors = FALSE)
  if(i < 7) {par(mar = c(1,4.5,1,1))}else{par(mar = c(2,4.5,1,1))}
      counter_restr_rain(vars[i],new_Xi,add_vars = adds[vars[i]][[1]], show_SEPP = TRUE,
                   xaxis_labs = ifelse(i < 7, FALSE, TRUE))
  title(main = paste0(letters[i],"."), adj = 0)
  if(i == 8)
  legend("bottomright", pch = 15, pt.cex = 2,
         col = alpha(c(ggsci::pal_jco("default")(10)[c(2,3,1)]), 0.7),
         legend = c("No SCMs","SCMs","Reference"))
}
par(mar = c(0,0,0,0))
plot.new()
title(xlab = "Rain in preceding 24 h (mm)", line = -1, font.lab = 2)
```

#### Figure 4. a. Total phosphorus, b. filterable reactive phosphorus, c. total nitrogen, d. nitrate + nitrite, e. ammonium, f. temperature, g. electrical conductivity and h. total suspended solids, predicted as a function of *rain1* (rain in the 24 h before sampling) under three scenarios in Ln, the catchment with the greatest stormwater control. In each panel, the lines and polygons show medians and 95% credible intervals, respectively, for scenarios: no stormwater control measures (SCMs) were installed (yellow), SCMs installed by the end of the study in the Ln catchment (grey), reference condition (0% EI~S1~). The vertical lines indicate the 75th (2 mm) and 90th (8 mm) percentile antecedent 24-h rainfall; the median was 0 mm. The red points in a, c, and g indicate the Victorian government objective for 75th percentile concentration of TP, TN, and EC respectively for Yarra region lowland streams [@epavic2021].

```{r fig_5, fig.width = 5, fig.height = 8}
comparisons <- read.csv("data/comparisons.csv")
exp_sites <- exp_sites[order(exp_sites$max_restr),]
lo <- layout(matrix(c(1:10), 10, 1, byrow = TRUE), heights = c(2,rep(10,7),12,5))
par(mar = c(0,0,0,0))
plot.new()
title(main = "i. 'No SCMs' - 'SCMs'                                  ii. 'SCMs' - 'reference'", 
      font.main = 2, cex.main = 1, line = -1.2)
par(mar = c(0,4.5,1,1))
for(v in 1:length(vars)){
if(v == 8) par(mar = c(2,4.5,1,1))
cp <- comparisons[comparisons$var == vars[v],]
if(vars[v] %in% c("tp","frp","nh3"))
  cp[c("d025","d050","d975")] <- cp[c("d025","d050","d975")]*1e3
plot(cp$x,cp$d050, type = 'n', ylim = range(c(cp$d025,cp$d975)),
     axes = FALSE, xlab = "", ylab = "")
labs1 <- rep(c(0,2,8,20),2)
if(v < 8) labs1 <- rep("",length(labs1))
axis(1, at = c(1:4,6:9) + c(rep(0.25,4),rep(-0.25,4)), labels =labs1)
axis(2, las = 1)
title(xlab = "Rain in preceding 24 h", ylab = ylab_expressions[[v]])
for(s in 1:dim(exp_sites)[1]){
  cs <- cp[cp$site == exp_sites$site[s],]
  cs$x <- cs$x + c(rep(0.25,4),rep(-0.25,4))
  sx <- cs$x + (s-3.5)/10
for(i in 1:dim(cs)[1]){
  lines(c(sx[i],sx[i]),c(cs$d025[i],cs$d975[i]), 
        col = RColorBrewer::brewer.pal(6,"RdYlBu")[s], lend = 1)
}
points(sx,cs$d050, pch = 21, 
       bg = RColorBrewer::brewer.pal(6,"RdYlBu")[s], col = "darkblue", cex = 0.75)
}
abline(h = 0, lty = 1, col = "grey")
abline(v = 5, lty = 1)
box()
title(main = paste0(" ", letters[v],"."), adj = 0, line = -1)
}
par(mar = c(0,0,0,0))
plot.new()
title(main = "Rain in preceding 24 h (mm)", 
      font.main = 2, cex.main = 1, line = -0.8)
  legend("bottomright", pch = 21, pt.bg = RColorBrewer::brewer.pal(6,"RdYlBu"),
         pt.cex = 0.8, legend = exp_sites$site, horiz = TRUE)


```

#### Figure 5. Differences (median and 95% credible intervals) in response variables in each of the six experimental site between three scenarios. The left panels show the difference between the response variable without SCMs ("No SCMs") and with SCMs as installed at the end of the study in each site ("SCMs"). The right panel shows the difference between the response variable with SCMs and reference condition. a. total phosphorus, b. filterable reactive phosphorus, c. total nitrogen, d. nitrate + nitrite, e ammonium, f. temperature, g. electrical conductivity and h. total suspended solids.

```{r Fig_6, fig.height=8, fig.width=5}
# 
lo <- layout(matrix(c(0,1:44,0,rep(45,4)),10,5,byrow=TRUE),
       widths = c(2,12,10,10,10),heights = c(2,rep(10,8),4))
par(mar = c(0,0,0,0))
for(i in 1:4){
  plot.new()
  title(main = paste0(tolower(as.roman(i)), ". after ", c(0,2,8,20)[i] ," mm"), line = -0.75)
}
par(mar = c(0,0,0,0))
plot.new()
title(ylab = expression(bold(paste("Total P (", mu, "g P/L)"))), line = -1.25)
new_X_tp <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_tp"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("tp", new_X_tp[new_X_tp$t == 1.5 & new_X_tp$season == 0,], 
                         main_lab = "a.")
plot.new()
title(ylab = expression(bold(paste("FRP (", mu, "g P/L)"))), line = -1.25)
new_X_frp <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_frp"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("frp", new_X_frp[new_X_frp$t == 1.5 & new_X_frp$season == 0 & new_X_frp$channel == 0,], main_lab = "b.")
plot.new()
title(ylab = expression(bold(paste("Total N (mg N/L)"))), line = -1.25)
new_X_tn <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_tn"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("tn", new_X_tn[new_X_tn$t == 1.5 & new_X_tn$season == 0 & new_X_tn$rain365 == 0,], main_lab = "c.")
plot.new()
title(ylab = expression(bold(paste("NO"[x], "(mg N/L)"))), line = -1.25)
new_X_nox <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_nox"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("nox", new_X_nox[new_X_nox$t == 1.5 & new_X_nox$season == 0 & new_X_nox$rain365 == 0,], main_lab = "d.")
plot.new()
title(ylab = expression(bold(paste("NH"[4]^+{}, " (", mu, "g N/L)"))), line = -1.25)
new_X_nh3 <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_nh3"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("nh3", new_X_nh3[new_X_nh3$t == 1.5 & new_X_nh3$season == 0 & new_X_nh3$rain365 == 0,], main_lab = "e.")
plot.new()
title(ylab = expression(bold(paste("Temp. (",degree,"C)"))), line = -1.25)
new_X_tem <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_tem"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("tem", new_X_tem[new_X_tem$t == 1.5 & new_X_tem$season == 1 &
                                      new_X_tem$diel == 1 & new_X_tem$rain365 == 0,], main_lab = "f.")
plot.new()
title(ylab = expression(bold(paste("EC (mS/cm)"))), line = -1.25)
new_X_ec <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_ec"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("ec", new_X_ec[new_X_ec$t == 1.5,], main_lab = "g.")
plot.new()
title(ylab = expression(bold(paste("TSS (mg/L)"))), line = -1.25)
new_X_tss <- data.frame(readxl::read_excel("data/prediction_set.xlsx", sheet = "new_X_tss"), stringsAsFactors = FALSE)
degrd_v_restr_plot4_in32("tss", new_X_tss[new_X_tss$t == 1.5 & new_X_tss$season == 0,], xax_labs = TRUE, main_lab = "h.")
par(mar = c(0,0,0,0))
plot.new()
title(xlab = "Effective imperviousness (%)", line = -1, font.lab = 2)

```

#### Figure 6. Response of the eight water quality variables to effective imperviousness (EI) among the study sites (line = mean trend with *EI~S1~*, shaded polygon = 95% credible intervals) after 4 levels of rainfall in preceding 24 h (i. 0 mm, ii. 2 mm, iii. 8 mm, iv. 20 mm). For each of the 6 experimental sites, a blue point designates the concentration at the *EI~S1~* (*degrd*, effective imperviousness assuming no stormwater control) of that site at the end of the study. The yellow point indicates the *EI~S~* (*degrd* - *restr*, effective imperviousness accounting for stormwater control performance) achieved at the end of the study. The blue lines (and credible intervals) therefore represent the degradation trajectories, and the yellow lines represent the restoration trajectories. For c. TN and d. NO~x~, the trend with EI was calculated with the *septic* effect set at the mean septic tank density among the study catchments, while the predictions for each experimental site were made with the *septic* value for that site.

## 4 Discussion

Like most studies of urban impacts on streams, we inferred the degrading effect of urban stormwater drainage from
spatial variation among streams. In this study, we have increased confidence in this 'space-for-time' inference [sensu
@pickett1989] by experimentally reducing drainage connection, and demonstrating changes in contaminant concentrations
and temperatures, compared to control and reference sites. By quantifying both the degrading effect of stormwater runoff
and the restorative effect of stormwater control in the same measure---effective imperviousness, as adapted by
@WalshEtAl_2022 ---we have been able to directly compare the trajectories of degradation and restoration. And by casting
our experiment in a Before-After-Control-Reference-Impact design, we have placed observed changes in the contexts of
departure from degraded state, and approach to reference state.

The effects on stream water quality in response to SCMs that we have demonstrated provide insights into the mechanisms
by which stormwater degrades stream water quality and by which SCMs mitigate that degradation, and potentially
non-stormwater-related impacts as well (Table 2). Here we first discuss those mechanisms, before considering
implications for better SCM design and for urban water management and protection of streams and rivers.

### 4.1 How stormwater degrades stream water quality, and how SCMs mitigate their effect

Stormwater drainage is as much a dry weather problem as a rain-related problem. The conventional approach to stormwater
drainage manages the risk of urban flooding, but in doing so, makes the risk of downstream environmental damage a
certainty. SCMs installed in this experiment had the greatest influence on stream water quality during dry weather.
There were two likely causes for this effect. First, baseflows, diminished by covering of catchment soils by impervious
surfaces, were likely augmented by SCMs, as evidenced by reduced temperatures and increased EC. While some of this
effect may be filtered flows through the pipe network, and exfiltrated flows through gravel-filled trenches and other
elements of the urban karst [@bonneau2018], increased EC suggests that exfiltrated water from SCMs also increased saline
groundwater flows into the streams. These increased flows likely diluted and cooled baseflows. Second, where we were
able to install SCMs that intercepted runoff from entire sub-catchments of pipes that convey runoff from roofs and
roads, SCMs prevented dry-weather spills from flowing to the stream. This was true even for the several end-of-pipe SCMs
that were suboptimal in that they only had the capacity to retain and treat runoff effectively up to 1-2 mm of rain, but
by providing dry-weather interception, they effectively intercepted any dry-weather spills that would otherwise have
flowed to the stream.

The saline groundwater in the study catchments is likely a legacy of historic septic tank seepage. Most properties in
the experimental catchments were sewered between 1985 and 1995 [@sew_2020; @yvw_2020], but some septic tanks remain
throughout all catchments, as the backlog of sewer connections remains an ongoing endeavor [@vicauditgen_2006]. It is
therefore possible that the SCM-induced increase in EC is temporary, and the legacy salts may flush out in the future.

A second legacy effect may in part explain the lack of effect of SCMs on TSS. While some of the higher TSS
concentrations found in the reference streams may result from runoff from unsealed (gravel) roads, which typically drain
directly to streams in some locations, it is more likely, particularly during dry weather, a result of the high bedloads
of silt in these streams, which are likely mobilized and remain in suspension under relatively low flows. In contrast,
the beds and banks of the control and experimental streams are dominated by consolidated clays, which are less able to
be mobilized during dry weather and small rainfall events. However, during larger events, these clay channels continue
to be eroded and incised, as observed during this study. Better understanding the sediment dynamics (both instream and
within the catchment) of catchments subject to implementation of SCMs requires further investigation.

Stormwater drainage is known to heat stream waters [@somers2013] and this can be exacerbated by SCMs that retain shallow
surface water such as wet ponds [@selbig2008]. The SCMs employed in this study that released water to the stream were
predominately sub-surface filtration systems without standing water, and these had a substantial cooling effect on dry
weather flows in the streams (Figure 4f), cooling maximum temperatures in Ln to close to that of reference streams.
Filtration-based stormwater control, thus has the potential not only to mitigate the thermal impacts of stormwater
runoff (4-5 C$^\circ$ warming in summer), but also the impacts of climate warming, which are likely to be somewhat less
[@ipcc_2021].

The SCMs employed in our study were designed to reduce total runoff volume and restore the quality and quantity of
reduced baseflows. They were less successful in achieving the former than the latter [@WalshEtAl_2022], and yet resulted
in substantial reductions in concentrations of N and P, suggesting that the observed effects were a result of treatment
rather than volume reduction, as posited by @jefferson2017. We also found no evidence of retained nutrients being
released during low flows, as observed in ponds and wetlands [@duan2016].

Most SCMs implemented in this study receive runoff from impervious surfaces through pipes or sealed drains, with little
or no contribution from pervious runoff. Reductions in N concentrations resulting from SCMs must primarily result from
either treatment of piped flows or dilution of stream flows with low-concentration filtered water. It is unlikely that
the SCMs actively treated nitrate-rich groundwater emanating from septic fields in the catchments. It is possible that
some high-nutrient seepage from septic fields could have leaked into stormwater drains. A more likely mechanism for
treatment associated with septic tanks arises from the occurrence of septic systems in the catchment that treat only
black water, with grey water drained informally to surrounding soils [@vicauditgen_2006]. In one property in the Ln
catchment, we found that, when the catchment's roads were sealed and curbed in 2005, the grey water from such a system
was diverted to the stormwater system. To deal with that problem, we constructed an infiltration system specifically for
those grey water flows. It is likely that similar grey-water flows connected to the stormwater occur undetected in any
of our experimental catchments, which our downslope raingardens would be intercepting.

### 4.2 How to better design and implement SCMs

The SCMs implemented in this project resulted in reduction of nutrient concentrations and water temperatures to levels
similar to reference sites, in dominant flow conditions, in several of the experimental catchments. However, phosphorus
concentrations and temperature remained substantially higher than reference concentrations during large rain events, in
all except the streams of the catchments in which substantial reductions in *EI~S~* were achieved (Figure 5). *EI~S~*
reductions achieved by the experiment were less than originally aimed for [@WalshEtAl_2022], because we were unable to
implement SCMs that intercepted runoff from many catchment impervious surfaces, and many SCMs had insufficient retention
capacity. The experimental SCMs fell short in two ways: insufficient coverage of impervious surfaces, and insufficient
retention capacity. Addressing these two shortcoming requires an ambitious and determined approach to SCM
implementation.

First, SCMs need to be applied at every scale, from the individual land parcel (i.e. households) to end-of-pipe systems,
designed to deal with runoff from the impervious areas in the catchment that were not able to be dealt with by at-source
or intermediate systems. Strategies that rely entirely on large, centralized end-of-pipe SCMs will likely fail, as they
will (i) likely be unable to ensure effective treatment with the large hydraulic loading they receive, (ii) likely be
distant from demands for their water, thus reducing their effectiveness in load reduction, and (iii) potentially cause
perverse effects, such as contributing to heating of waters subsequently discharged to receiving waters
[@stajkowski2021]. Similarly, strategies based only on at-source application of SCMs will likely fail, because
inevitably space or other constraints will preclude application of SCMs to some impervious areas, as we observed in this
experimental intervention [@walsh2015]. A comprehensive, integrated approach is therefore needed, so that upstream
systems reduce the hydraulic loading on downstream systems, and downstream systems act as insurance for upstream SCMs
that fail, or for runoff from untreated impervious areas. In some instances it may be appropriate to purchase private
land, where that land would allow implementation of an SCM that is critical to dealing with otherwise unmitigated
runoff.

Increasing retention capacity depends on the amount of demand for harvested stormwater [@walsh2016], as well as
maximizing opportunities for evapotranspiration. Maximizing the amount of demand requires end-uses which are regular
(e.g. indoor uses) rather than seasonal (e.g. irrigation). Without these regular demands, rainwater and stormwater
harvesting storages will remain full for much of the year [@mitchell2007], leading to frequent discharge of unmitigated
runoff. SCMs should therefore be positioned to permit distribution of water from them to meet demands. This is typically
done by locating rainwater tanks at the land parcel scale. Larger scale, more centralized application (i.e. central
storage with reticulation back to demands) will be difficult to achieve in existing urban areas, but may be possible
where redevelopment or new development is being proposed.

Evapotranspiration can be actively increased (by harvesting and then irrigation of green space), but increases can also
be achieved through passively-irrigated street-tree pits [@luketich2019], or through designing stormwater treatment
systems to maximize exfiltration and planting deep-rooted, high water-demand vegetation (typically trees) nearby.
Western et al. [-@western2021] demonstrated that this strategy can not only reduce the overall runoff volume, but can
protect urban vegetation from water stress, with benefits for urban amenity and livability.

One important concern not considered by this study is the effectiveness of SCMs in intercepting and retaining
micropollutants, microbes, heavy metals, hydrocarbons and other emerging pollutants of concerns. Many of these
contaminants can be highly mobile, with several studies showing varied effectiveness of SCMs in retaining them
[@schmitt2015; @lefevre2015]. Widespread implementation of SCMs in a catchment should ideally follow a detailed audit of
the pollutant profile, allowing the design of control measures to be optimized to treat the contaminants of concern.
Attention will also need to be paid to the long-term water quality treatment performance of SCMs, including the need to
maintain filter media and replace them before chemical saturation, to avoid breakthrough.

### 4.3 Implications for stream restoration and protection

The prediction of in-stream water quality as a function of *EI~S~* lends strength to the proposition that ecologically
successful restoration of urban streams [sensu @palmer2005] requires management intervention at a catchment scale to
match the scale of the stormwater drainage impacts, rather than small-scale restoration of stream habitat
[@bernhardt2011]. The relatively small effect on concentrations of the channel excavation upstream of Ln (i.e. the
*channel* effect) compared to the effects of SCMs further points to a relatively small influence of local disturbances
compared to the catchment-scale disturbance of urban stormwater drainage.

Restoration of water quality and flow regime is a fundamental basis for restoration of ecological structure and
function, and retention and treatment of stormwater is critical to achieving that. Our study has shown that
appropriately designed SCMs applied at a range of scales can contribute predictably to restoring water quality (and
through indirect evidence, dry-weather flows) in degraded urban streams. Because *EI~S~* integrates measures of SCM
performance in its formulation [@WalshEtAl_2022], it can be used to assess the effects of potential SCM designs and
implementation strategies, to predict in-stream water quality responses and prioritize management actions.

For example, the combination of large-scale harvesting and infiltration systems implemented in the Ln catchment was
sufficient to reduce TP concentrations during dominant flow conditions, to meet the Victorian Government environmental
protection objective for TP (Figure 4A). The potential for alternative SCM design to meet such an objective can be
predicted by estimation of the resulting EIS . However, the less certain achievement of the TN objective (Figure 4C) and
the failure to meet the EC objective (Figure 4g) further illustrate the complexity of urban impacts. In our study
catchments, which were urbanized in the 1970s, but not sewered until \~20 years later, water quality responses to
mitigation of stormwater impacts are complicated by legacy effects, particularly those of septic tanks.

Variation in nitrogen concentration, in particular its dominant form, NO~x~, among our study sites, including reference
sites, was most strongly explained by septic tank density. Two of the reference sites had the highest septic tank
density of all catchments (Table 1). Despite high septic density, and high NO~x~ concentrations, the reference sites Sa
and Ol retained a high degree of ecological integrity: diverse invertebrate communities dominated by sensitive taxa
[@walsh2004], leaf breakdown primarily mediated by shredder species [@imberger2008], and low-biomass algal assemblages
[@taylor2004] dominated by eutrophic species [@newall2005]. These biotic attributes of the reference streams, together
with the low concentrations of reactive phosphorus (Figure 4b), suggest that phosphorus, rather than nitrogen, limits
primary productivity, with elevated nitrogen concentrations having little ecological effect. The substantial reductions
in P that were achieved by SCM implementation in Ln, Ls, L4 and D8 are therefore likely to influence ecological change
in these study streams (the subject of ongoing study). Although SCM implementation reduced in-stream nitrogen
concentrations, further reductions, in urban and reference streams alike, will likely require retirement of septic tanks
in these catchments.

The elevated EC in the urban study catchments is likely to limit the colonization and persistence of some salt-sensitive
species [e.g. @kefford2018], and the increase caused by SCM implementation is likely to exacerbate this limitation.
Spatial variation in EI (*degrd*) explained some of the variation in EC (Figure 3g, 4g), likely caused in part by
elevated salt concentrations in impervious runoff from the leaching and weathering of built surfaces, particularly
concrete [@kaushal2017]. However, the SCM-induced, dry-weather increases in EC suggest elevated groundwater salinity,
likely a legacy of historic septic tanks, but potentially a legacy of pre-urban agricultural activities as well.
Infiltration of urban stormwater runoff (which is less saline, as evidenced by reduced EC with higher rainfall) into
catchment soils is likely to result in long-term dilution of groundwater flows, over longer time frames than was
possible in this study. SCMs are therefore most likely an appropriate tool for addressing this legacy problem for a
long-term achievement of the EC target.

Such legacy effects, and indeed contemporary impacts such as inadequate sewage treatment and disposal [@piffer2021], are
likely to be common in many urban catchments globally. Where problems such as inadequately treated sewage or industrial
effluent are present, they should clearly be management priorities. However addressing such problems without recognition
of the problem of stormwater misses an opportunity to more comprehensively restore stream ecological structure and
function. Our study has demonstrated that stream water quality is impaired by small areas of conventionally drained
impervious surfaces, and SCMs designed to retain and lose or treat stormwater runoff from all or near-all catchment
impervious surfaces is required to mitigate such impairment to a level approaching the pre-urban state. Stormwater
management to such a standard is being implemented in priority areas of the Melbourne region [@mw_2018]. While broader
adoption of such an objective is likely to be challenging under dominant urban water management policy and practice, the
potential co-benefits of alternative stormwater management can be large [@walsh2016].

Protection and ecologically successful restoration of river and stream ecosystems are likely to require approaches to
stormwater control beyond those that currently dominate [@walsh2016]. If river and stream protection is an objective,
more ambitious targets are required than, for instance, those of most Mid-Atlantic municipalities, which have a goal of
achieving 10--20% of the landscape drain runoff through SCMs by 2030 [@pennino2016]. Stream protection will require
changing standard drainage practice so that conventional drainage is no longer the default. It will require near-100% of
impervious surfaces draining to SCMs (noting that SCMs should be designed for interception of runoff from impervious
surfaces, not from entire landscapes: @pennino2016). It will require SCMs in treatment trains at a range of scales from
land-parcel to the largest sub-catchment that enters a stream, and with the terminal treatment supported as much as
possible by upstream treatments.

#### Table 2. A summary of degrading mechanisms relevant to our study streams, and evidence from this study for any mitigating effect of stormwater control measures.

+-----------------------------------------------------------+-----------------------------------------------------------+
| Degrading mechanism                                       | Mitigated by stormwater control measures                  |
+===========================================================+===========================================================+
| [**STORMWATER (*degrd* effect)**]{.underline}             |                                                           |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 1.  Dry weather spills or septic seepage to stormwater    | Yes: reduced dry-weather P, N                             |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 2.  Frequent hydraulic and chemical disturbance from      | Yes: reduced P, N, temperature after up to 8 mm rain      |
|     storm runoff                                          |                                                           |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 3.  Reduced baseflows                                     | Yes: reduced dry-weather temperature (and increased EC)   |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 4.  Incision and widening from increased stream power     | Unclear: lack of SCM impact on TSS suggests SCMs may not  |
|                                                           | have mitigated this effect: in-channel vs. catchment      |
|                                                           | sources need further investigation                        |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 5.  Warmer, lighter in-stream conditions (resulting from  | Yes: reduced temperature                                  |
|     3 and 4)                                              |                                                           |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 6.  Loss of fine to coarse sediments (resulting from 4),  | No: no change in TSS                                      |
|     perhaps leading to reduced TSS                        |                                                           |
+-----------------------------------------------------------+-----------------------------------------------------------+
| [**SEPTIC TANK/GREY WATER SEEPAGE (*septic*               |                                                           |
| effect)**]{.underline}                                    |                                                           |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 1.  To stormwater drains                                  | Yes: reduced N                                            |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 2.  To groundwater                                        | Possibly: reduced N                                       |
+-----------------------------------------------------------+-----------------------------------------------------------+
| [**CLIMATE CHANGE (*time* effect)**]{.underline}          |                                                           |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 1.  Potential reduced dry weather flows                   | Yes: reduced dry-weather temperature, increased EC        |
+-----------------------------------------------------------+-----------------------------------------------------------+
| 2.  Warming                                               | Yes: reduced temperature                                  |
+-----------------------------------------------------------+-----------------------------------------------------------+

## Acknowledgments

The primary research activities of this project were funded by: the Australian Research Council (ARC) Linkage Program
(LP0883610 and LP130100295, to CJW and TDF) with partner organizations Melbourne Water (MW) and Yarra Ranges Council
(YRC); and the ARC Future Fellowship Program (FT10010044, to TDF). MW also funded research activities through the
Cooperative Research Centres for Freshwater Ecology and Catchment Hydrology, and the Melbourne Waterway
Research-Practice Partnership. The Smart Water Fund of the Victorian Water Trust also funded research activities.

Programs for planning, allocating, building and maintaining stormwater control measures (SCMs) in the L4 catchment were
funded by: a) the Victorian Government through the Smart Water Fund of the Victorian Water Trust, the Victorian Urban
Stormwater and Recycling Fund, and through Melbourne Water as part of the Port Phillip and Westernport Threatened
Catchments program and Living Rivers program; b) MW; c) the Australian Government through the Caring for Our Country
Investment Fund, administered by the Port Phillip and Westernport Catchment Management Authority; d) YRC; e) Yarra
Valley Water. Similar programs in the D8 catchment were funded and managed by MW in collaboration with Knox City Council
and South East Water.

MW is a corporation wholly owned by the Government of Victoria, with statutory responsibilities for the management of
rivers and other waterways of the Melbourne region. They fund public-good research to further the environmental
sustainability of their operations. The research and the University of Melbourne positions held by CJW, MJB, DGB, and
SJI are all funded by the Melbourne Waterway Research-Practice Partnership, between the University of Melbourne and
Melbourne Water (MW). In a previous role, TDF received payment as for his contribution to the engineering design of the
Wicks Reserve Infiltration System, subsequently constructed by Knox City Council (KCC) and MW in the D8 catchment.
Neither the authors' partnership with and funding by MW, nor past work with KCC, alter their adherence to AGU's ethical
guidelines.

We thank Graham Rooney, Rhys Coleman, Toby Prosser and Sharyn Rossrakesh from MW for their steadfast support of this
project. Belinda Hatt, Sally Boer, Monica Tewman, Ashley Macqueen, Tony Lovell, Mike Sammonds, Carleen Mitchell, Rob
James, and Genevieve Hehir assisted with collection of samples. Belinda Hatt, Sandra Sdraulig, Ashley Liang and Tina
Hines conducted the laboratory analyses. We thank Lee Hazel for guidance with modeling, Rhys Eddy for sewerage
information and Vaughn Grey, Matt Potter, Rhys Coleman and Judy Blackbeard for comments on the manuscript.

Sampling in reference streams was conducted with Parks Victoria research permits (10007079, 10007127 and 10008347).

## References
